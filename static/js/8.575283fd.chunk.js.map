{"version":3,"sources":["../../../packages/ra-data-graphql/esm/introspection.js","../../../packages/ra-data-graphql/esm/index.js","../../../packages/ra-data-graphql/esm/buildApolloClient.js","../../../packages/ra-data-graphql/esm/constants.js","../../../packages/ra-data-graphql-simple/esm/getFinalType.js","../../../packages/ra-data-graphql-simple/esm/isList.js","../../../packages/ra-data-graphql-simple/esm/buildVariables.js","../../../packages/ra-data-graphql-simple/esm/isRequired.js","../../../packages/ra-data-graphql-simple/esm/buildGqlQuery.js","../../../packages/ra-data-graphql-simple/esm/getResponseParser.js","../../../packages/ra-data-graphql-simple/esm/buildQuery.js","../../../packages/ra-data-graphql-simple/esm/index.js","dataProvider/graphql.ts"],"names":["templateObject_1","_a","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","QUERY_TYPES","GET_LIST","GET_MANY","GET_MANY_REFERENCE","GET_ONE","MUTATION_TYPES","CREATE","UPDATE","DELETE","UPDATE_MANY","DELETE_MANY","ALL_TYPES","concat","__makeTemplateObject","cooked","raw","defineProperty","value","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","rejected","result","done","adopt","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","Symbol","iterator","v","op","TypeError","pop","push","__spreadArrays","il","r","Array","k","a","j","jl","INNER_QUERY_TYPES","defaultOptions","resolveIntrospection","client","options","schema","queries","types","isResource","buildResource","filteredResources","resources","_b","query","fetchPolicy","gql","getIntrospectionQuery","data","__schema","reduce","acc","type","name","queryType","mutationType","fields","filter","isResourceIncluded","include","isArray","includes","isResourceExcluded","exclude","some","operationNames","aorFetchType","find","map","introspection","resource","pluralize","undefined","getOptions","clientObject","clientOptions","buildQueryFactory","override","otherOptions","introspectionResults","buildQuery","raDataProvider","_c","merge","console","warn","ApolloClient","cache","link","uri","finalLink","finalCache","fragmentMatcher","IntrospectionFragmentMatcher","introspectionQueryResultData","HttpLink","InMemoryCache","restore","buildApolloClient","params","overriddenBuildQuery","get","parseResponse_1","parseResponse","getQueryOperation","apolloQuery_1","response","apolloQuery","mutation","variables","mutate","observeRequest","watchQuery","saga","definitions","operation","Error","getFinalType","kind","TypeKind","NON_NULL","LIST","ofType","isList","sanitizeValue","parseInt","parseFloat","prepareParams","keys","forEach","key","param","arg","args","item","File","Date","toISOString","inputFields","castType","realType","Number","String","Boolean","buildGetListVariables","_d","_e","_f","_g","_h","_j","ids","filterSome","parts","split","type_1","id","resourceField_1","resourceField","type_2","isAList","pagination","page","perPage","sort","sortField","field","sortOrder","order","isRequired","buildFragments","possibleTypes","possibleType","linkedType","gqlTypes","buildFields","path","startsWith","OBJECT","INTERFACE","getArgType","required","buildArgs","validVariables","sanitizeResource","dataKey","d","buildVariablesImpl","buildGqlQueryImpl","getResponseParserImpl","knownResources","resourceName","join","preparedParams","target","buildCreateUpdateVariables","metaVariables","apolloArgs","buildApolloArgs","metaArgs","items","total","count","defaultBuildQuery","getGqlResource","customBuildQuery","buildDataProvider","defaultDataProvider","fetchType","otherParams_1","all","results","data_1","otherParams_2","dataProvider"],"mappings":"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","file":"static/js/8.575283fd.chunk.js","sourcesContent":["var __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n    return cooked;\n};\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport { getIntrospectionQuery } from 'graphql';\nimport gql from 'graphql-tag';\nimport { GET_LIST, GET_ONE } from 'ra-core';\nimport { ALL_TYPES } from './constants';\nexport var isResourceIncluded = function (_a) {\n    var include = _a.include, type = _a.type;\n    if (Array.isArray(include)) {\n        return include.includes(type.name);\n    }\n    if (typeof include === 'function') {\n        return include(type);\n    }\n    return false;\n};\nexport var isResourceExcluded = function (_a) {\n    var exclude = _a.exclude, type = _a.type;\n    if (Array.isArray(exclude)) {\n        return exclude.includes(type.name);\n    }\n    if (typeof exclude === 'function') {\n        return exclude(type);\n    }\n    return false;\n};\n/**\n * @param {ApolloClient} client The Apollo client\n * @param {Object} options The introspection options\n */\nexport default (function (client, options) { return __awaiter(void 0, void 0, void 0, function () {\n    var schema, _a, queries, types, isResource, buildResource, filteredResources, resources;\n    return __generator(this, function (_b) {\n        switch (_b.label) {\n            case 0:\n                if (!options.schema) return [3 /*break*/, 1];\n                _a = options.schema;\n                return [3 /*break*/, 3];\n            case 1: return [4 /*yield*/, client\n                    .query({\n                    fetchPolicy: 'network-only',\n                    query: gql(templateObject_1 || (templateObject_1 = __makeTemplateObject([\"\\n                      \", \"\\n                  \"], [\"\\n                      \", \"\\n                  \"])), getIntrospectionQuery()),\n                })\n                    .then(function (_a) {\n                    var __schema = _a.data.__schema;\n                    return __schema;\n                })];\n            case 2:\n                _a = _b.sent();\n                _b.label = 3;\n            case 3:\n                schema = _a;\n                queries = schema.types.reduce(function (acc, type) {\n                    if (type.name !== (schema.queryType && schema.queryType.name) &&\n                        type.name !== (schema.mutationType && schema.mutationType.name))\n                        return acc;\n                    return __spreadArrays(acc, type.fields);\n                }, []);\n                types = schema.types.filter(function (type) {\n                    return type.name !== (schema.queryType && schema.queryType.name) &&\n                        type.name !== (schema.mutationType && schema.mutationType.name);\n                });\n                isResource = function (type) {\n                    if (isResourceIncluded(__assign({ type: type }, options)))\n                        return true;\n                    if (isResourceExcluded(__assign({ type: type }, options)))\n                        return false;\n                    return (queries.some(function (query) { return query.name === options.operationNames[GET_LIST](type); }) &&\n                        queries.some(function (query) { return query.name === options.operationNames[GET_ONE](type); }));\n                };\n                buildResource = function (type) {\n                    return ALL_TYPES.reduce(function (acc, aorFetchType) {\n                        var _a;\n                        return (__assign(__assign({}, acc), (_a = {}, _a[aorFetchType] = queries.find(function (query) {\n                            return options.operationNames[aorFetchType] &&\n                                query.name ===\n                                    options.operationNames[aorFetchType](type);\n                        }), _a)));\n                    }, { type: type });\n                };\n                filteredResources = types.filter(isResource);\n                resources = filteredResources.map(buildResource);\n                return [2 /*return*/, {\n                        types: types,\n                        queries: queries,\n                        resources: resources,\n                        schema: schema,\n                    }];\n        }\n    });\n}); });\nvar templateObject_1;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar _a;\nimport merge from 'lodash/merge';\nimport get from 'lodash/get';\nimport pluralize from 'pluralize';\nimport { GET_LIST, GET_ONE, GET_MANY, GET_MANY_REFERENCE, CREATE, UPDATE, DELETE, } from 'ra-core';\nimport buildApolloClient from './buildApolloClient';\nimport { QUERY_TYPES as INNER_QUERY_TYPES, MUTATION_TYPES as INNER_MUTATION_TYPES, ALL_TYPES as INNER_ALL_TYPES, } from './constants';\nimport defaultResolveIntrospection from './introspection';\nexport var QUERY_TYPES = INNER_QUERY_TYPES;\nexport var MUTATION_TYPES = INNER_MUTATION_TYPES;\nexport var ALL_TYPES = INNER_ALL_TYPES;\nvar defaultOptions = {\n    resolveIntrospection: defaultResolveIntrospection,\n    introspection: {\n        operationNames: (_a = {},\n            _a[GET_LIST] = function (resource) { return \"all\" + pluralize(resource.name); },\n            _a[GET_ONE] = function (resource) { return \"\" + resource.name; },\n            _a[GET_MANY] = function (resource) { return \"all\" + pluralize(resource.name); },\n            _a[GET_MANY_REFERENCE] = function (resource) { return \"all\" + pluralize(resource.name); },\n            _a[CREATE] = function (resource) { return \"create\" + resource.name; },\n            _a[UPDATE] = function (resource) { return \"update\" + resource.name; },\n            _a[DELETE] = function (resource) { return \"delete\" + resource.name; },\n            _a),\n        exclude: undefined,\n        include: undefined,\n    },\n};\nvar getOptions = function (options, aorFetchType, resource) {\n    if (typeof options === 'function') {\n        return options(resource, aorFetchType);\n    }\n    return options;\n};\nexport default (function (options) { return __awaiter(void 0, void 0, void 0, function () {\n    var _a, clientObject, clientOptions, introspection, resolveIntrospection, buildQueryFactory, _b, override, otherOptions, client, introspectionResults, buildQuery, raDataProvider;\n    return __generator(this, function (_c) {\n        switch (_c.label) {\n            case 0:\n                _a = merge({}, defaultOptions, options), clientObject = _a.client, clientOptions = _a.clientOptions, introspection = _a.introspection, resolveIntrospection = _a.resolveIntrospection, buildQueryFactory = _a.buildQuery, _b = _a.override, override = _b === void 0 ? {} : _b, otherOptions = __rest(_a, [\"client\", \"clientOptions\", \"introspection\", \"resolveIntrospection\", \"buildQuery\", \"override\"]);\n                if (override && process.env.NODE_ENV === 'production') {\n                    console.warn(\n                    // eslint-disable-line\n                    'The override option is deprecated. You should instead wrap the buildQuery function provided by the dataProvider you use.');\n                }\n                client = clientObject || buildApolloClient(clientOptions);\n                if (!introspection) return [3 /*break*/, 2];\n                return [4 /*yield*/, resolveIntrospection(client, introspection)];\n            case 1:\n                introspectionResults = _c.sent();\n                _c.label = 2;\n            case 2:\n                buildQuery = buildQueryFactory(introspectionResults, otherOptions);\n                raDataProvider = function (aorFetchType, resource, params) {\n                    var overriddenBuildQuery = get(override, resource + \".\" + aorFetchType);\n                    try {\n                        var _a = overriddenBuildQuery\n                            ? __assign(__assign({}, buildQuery(aorFetchType, resource, params)), overriddenBuildQuery(params)) : buildQuery(aorFetchType, resource, params), parseResponse_1 = _a.parseResponse, query = __rest(_a, [\"parseResponse\"]);\n                        var operation = getQueryOperation(query.query);\n                        if (operation === 'query') {\n                            var apolloQuery_1 = __assign(__assign(__assign({}, query), { fetchPolicy: 'network-only' }), getOptions(otherOptions.query, aorFetchType, resource));\n                            return client\n                                .query(apolloQuery_1)\n                                .then(function (response) { return parseResponse_1(response); });\n                        }\n                        var apolloQuery = __assign({ mutation: query.query, variables: query.variables }, getOptions(otherOptions.mutation, aorFetchType, resource));\n                        return client.mutate(apolloQuery).then(parseResponse_1);\n                    }\n                    catch (e) {\n                        return Promise.reject(e);\n                    }\n                };\n                raDataProvider.observeRequest = function (aorFetchType, resource, params) {\n                    var _a = buildQuery(aorFetchType, resource, params), parseResponse = _a.parseResponse, query = __rest(_a, [\"parseResponse\"]);\n                    var apolloQuery = __assign(__assign({}, query), getOptions(otherOptions.watchQuery, aorFetchType, resource));\n                    return client.watchQuery(apolloQuery).then(parseResponse);\n                };\n                raDataProvider.saga = function () { };\n                return [2 /*return*/, raDataProvider];\n        }\n    });\n}); });\nvar getQueryOperation = function (query) {\n    if (query && query.definitions && query.definitions.length > 0) {\n        return query.definitions[0].operation;\n    }\n    throw new Error('Unable to determine the query operation');\n};\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { ApolloClient } from 'apollo-client';\nimport { HttpLink, InMemoryCache, IntrospectionFragmentMatcher, } from 'apollo-client-preset';\nexport default (function (options) {\n    if (!options) {\n        return new ApolloClient();\n    }\n    var cache = options.cache, link = options.link, uri = options.uri, otherOptions = __rest(options, [\"cache\", \"link\", \"uri\"]);\n    var finalLink = link;\n    var finalCache = cache;\n    // Create an empty fragment matcher\n    // See: https://github.com/apollographql/apollo-client/issues/3397#issuecomment-421433032\n    var fragmentMatcher = new IntrospectionFragmentMatcher({\n        introspectionQueryResultData: {\n            __schema: {\n                types: [],\n            },\n        },\n    });\n    if (!link && uri) {\n        finalLink = new HttpLink({ uri: uri });\n    }\n    if (!cache) {\n        finalCache = new InMemoryCache({ fragmentMatcher: fragmentMatcher }).restore({});\n    }\n    return new ApolloClient(__assign({ link: finalLink, cache: finalCache }, otherOptions));\n});\n","import { GET_LIST, GET_ONE, GET_MANY, GET_MANY_REFERENCE, CREATE, UPDATE, UPDATE_MANY, DELETE, DELETE_MANY, } from 'ra-core';\nexport var QUERY_TYPES = [GET_LIST, GET_MANY, GET_MANY_REFERENCE, GET_ONE];\nexport var MUTATION_TYPES = [\n    CREATE,\n    UPDATE,\n    DELETE,\n    UPDATE_MANY,\n    DELETE_MANY,\n];\nexport var ALL_TYPES = QUERY_TYPES.concat(MUTATION_TYPES);\n","import { TypeKind } from 'graphql';\n/**\n * Ensure we get the real type even if the root type is NON_NULL or LIST\n * @param {GraphQLType} type\n */\nvar getFinalType = function (type) {\n    if (type.kind === TypeKind.NON_NULL || type.kind === TypeKind.LIST) {\n        return getFinalType(type.ofType);\n    }\n    return type;\n};\nexport default getFinalType;\n","import { TypeKind } from 'graphql';\nvar isList = function (type) {\n    if (type.kind === TypeKind.NON_NULL) {\n        return isList(type.ofType);\n    }\n    return type.kind === TypeKind.LIST;\n};\nexport default isList;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\n/* eslint-disable default-case */\nimport { GET_LIST, GET_ONE, GET_MANY, GET_MANY_REFERENCE, CREATE, UPDATE, DELETE, } from 'ra-core';\nimport getFinalType from './getFinalType';\nimport isList from './isList';\nvar sanitizeValue = function (type, value) {\n    if (type.name === 'Int') {\n        return parseInt(value, 10);\n    }\n    if (type.name === 'Float') {\n        return parseFloat(value);\n    }\n    return value;\n};\nvar castType = function (value, type) {\n    var realType = type.kind === 'NON_NULL' ? type.ofType : type;\n    switch (realType.kind + \":\" + realType.name) {\n        case 'SCALAR:Int':\n            return Number(value);\n        case 'SCALAR:String':\n            return String(value);\n        case 'SCALAR:Boolean':\n            return Boolean(value);\n        default:\n            return value;\n    }\n};\nvar prepareParams = function (params, queryType, introspectionResults) {\n    var result = {};\n    if (!params) {\n        return params;\n    }\n    Object.keys(params).forEach(function (key) {\n        var param = params[key];\n        var arg = null;\n        if (!param) {\n            result[key] = param;\n            return;\n        }\n        if (queryType && Array.isArray(queryType.args)) {\n            arg = queryType.args.find(function (item) { return item.name === key; });\n        }\n        if (param instanceof File) {\n            result[key] = param;\n            return;\n        }\n        if (param instanceof Date) {\n            result[key] = param.toISOString();\n            return;\n        }\n        if (param instanceof Object &&\n            !Array.isArray(param) &&\n            arg &&\n            arg.type.kind === 'INPUT_OBJECT') {\n            var args = introspectionResults.types.find(function (item) {\n                return item.kind === arg.type.kind && item.name === arg.type.name;\n            }).inputFields;\n            result[key] = prepareParams(param, { args: args }, introspectionResults);\n            return;\n        }\n        if (param instanceof Object &&\n            !param instanceof Date &&\n            !Array.isArray(param)) {\n            result[key] = prepareParams(param, queryType, introspectionResults);\n            return;\n        }\n        if (!arg) {\n            result[key] = param;\n            return;\n        }\n        result[key] = castType(param, arg.type);\n    });\n    return result;\n};\nvar buildGetListVariables = function (introspectionResults) { return function (resource, aorFetchType, params) {\n    var variables = { filter: {} };\n    if (params.filter) {\n        variables.filter = Object.keys(params.filter).reduce(function (acc, key) {\n            var _a, _b, _c, _d, _e, _f, _g;\n            var _h, _j;\n            if (key === 'ids') {\n                return __assign(__assign({}, acc), { ids: params.filter[key] });\n            }\n            if (typeof params.filter[key] === 'object') {\n                var type = introspectionResults.types.find(function (t) { return t.name === resource.type.name + \"Filter\"; });\n                var filterSome = (_h = type === null || type === void 0 ? void 0 : type.inputFields) === null || _h === void 0 ? void 0 : _h.find(function (t) { return t.name === key + \"_some\"; });\n                if (filterSome) {\n                    var filter = Object.keys(params.filter[key]).reduce(function (acc, k) {\n                        var _a;\n                        return (__assign(__assign({}, acc), (_a = {}, _a[k + \"_in\"] = params.filter[key][k], _a)));\n                    }, {});\n                    return __assign(__assign({}, acc), (_a = {}, _a[key + \"_some\"] = filter, _a));\n                }\n            }\n            var parts = key.split('.');\n            if (parts.length > 1) {\n                if (parts[1] === 'id') {\n                    var type_1 = introspectionResults.types.find(function (t) { return t.name === resource.type.name + \"Filter\"; });\n                    var filterSome = (_j = type_1 === null || type_1 === void 0 ? void 0 : type_1.inputFields) === null || _j === void 0 ? void 0 : _j.find(function (t) { return t.name === parts[0] + \"_some\"; });\n                    if (filterSome) {\n                        return __assign(__assign({}, acc), (_b = {}, _b[parts[0] + \"_some\"] = { id: params.filter[key] }, _b));\n                    }\n                    return __assign(__assign({}, acc), (_c = {}, _c[parts[0]] = { id: params.filter[key] }, _c));\n                }\n                var resourceField_1 = resource.type.fields.find(function (f) { return f.name === parts[0]; });\n                var type = getFinalType(resourceField_1.type);\n                return __assign(__assign({}, acc), (_d = {}, _d[key] = sanitizeValue(type, params.filter[key]), _d));\n            }\n            var resourceField = resource.type.fields.find(function (f) { return f.name === key; });\n            if (resourceField) {\n                var type_2 = getFinalType(resourceField.type);\n                var isAList = isList(resourceField.type);\n                if (isAList) {\n                    return __assign(__assign({}, acc), (_e = {}, _e[key] = Array.isArray(params.filter[key])\n                        ? params.filter[key].map(function (value) {\n                            return sanitizeValue(type_2, value);\n                        })\n                        : sanitizeValue(type_2, [params.filter[key]]), _e));\n                }\n                return __assign(__assign({}, acc), (_f = {}, _f[key] = sanitizeValue(type_2, params.filter[key]), _f));\n            }\n            return __assign(__assign({}, acc), (_g = {}, _g[key] = params.filter[key], _g));\n        }, {});\n    }\n    if (params.pagination) {\n        variables.page = parseInt(params.pagination.page, 10) - 1;\n        variables.perPage = parseInt(params.pagination.perPage, 10);\n    }\n    if (params.sort) {\n        variables.sortField = params.sort.field;\n        variables.sortOrder = params.sort.order;\n    }\n    return variables;\n}; };\nvar buildCreateUpdateVariables = function (resource, aorFetchType, params, queryType) {\n    return Object.keys(params.data).reduce(function (acc, key) {\n        var _a, _b, _c;\n        if (Array.isArray(params.data[key])) {\n            var arg = queryType.args.find(function (a) { return a.name === key + \"Ids\"; });\n            if (arg) {\n                return __assign(__assign({}, acc), (_a = {}, _a[key + \"Ids\"] = params.data[key].map(function (_a) {\n                    var id = _a.id;\n                    return id;\n                }), _a));\n            }\n        }\n        if (typeof params.data[key] === 'object') {\n            var arg = queryType.args.find(function (a) { return a.name === key + \"Id\"; });\n            if (arg) {\n                return __assign(__assign({}, acc), (_b = {}, _b[key + \"Id\"] = params.data[key].id, _b));\n            }\n        }\n        return __assign(__assign({}, acc), (_c = {}, _c[key] = params.data[key], _c));\n    }, {});\n};\nexport default (function (introspectionResults) { return function (resource, aorFetchType, params, queryType) {\n    var _a;\n    var preparedParams = prepareParams(params, queryType, introspectionResults);\n    switch (aorFetchType) {\n        case GET_LIST: {\n            return buildGetListVariables(introspectionResults)(resource, aorFetchType, preparedParams, queryType);\n        }\n        case GET_MANY:\n            return {\n                filter: { ids: preparedParams.ids },\n            };\n        case GET_MANY_REFERENCE: {\n            var variables = buildGetListVariables(introspectionResults)(resource, aorFetchType, preparedParams, queryType);\n            variables.filter = __assign(__assign({}, variables.filter), (_a = {}, _a[preparedParams.target] = preparedParams.id, _a));\n            return variables;\n        }\n        case GET_ONE:\n        case DELETE:\n            return {\n                id: preparedParams.id,\n            };\n        case CREATE:\n        case UPDATE: {\n            return buildCreateUpdateVariables(resource, aorFetchType, preparedParams, queryType);\n        }\n    }\n}; });\n","import { TypeKind } from 'graphql';\nvar isRequired = function (type) {\n    if (type.kind === TypeKind.LIST) {\n        return isRequired(type.ofType);\n    }\n    return type.kind === TypeKind.NON_NULL;\n};\nexport default isRequired;\n","var __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport { GET_LIST, GET_MANY, GET_MANY_REFERENCE, DELETE } from 'ra-core';\nimport { QUERY_TYPES } from 'ra-data-graphql';\nimport { TypeKind } from 'graphql';\nimport * as gqlTypes from 'graphql-ast-types-browser';\nimport getFinalType from './getFinalType';\nimport isList from './isList';\nimport isRequired from './isRequired';\nexport var buildFragments = function (introspectionResults) { return function (possibleTypes) {\n    return possibleTypes.reduce(function (acc, possibleType) {\n        var type = getFinalType(possibleType);\n        var linkedType = introspectionResults.types.find(function (t) { return t.name === type.name; });\n        return __spreadArrays(acc, [\n            gqlTypes.inlineFragment(gqlTypes.selectionSet(buildFields(introspectionResults)(linkedType.fields)), gqlTypes.namedType(gqlTypes.name(type.name))),\n        ]);\n    }, []);\n}; };\nexport var buildFields = function (introspectionResults, path) {\n    if (path === void 0) { path = []; }\n    return function (fields) {\n        return fields.reduce(function (acc, field) {\n            var type = getFinalType(field.type);\n            if (type.name.startsWith('_')) {\n                return acc;\n            }\n            if (type.kind !== TypeKind.OBJECT && type.kind !== TypeKind.INTERFACE) {\n                return __spreadArrays(acc, [gqlTypes.field(gqlTypes.name(field.name))]);\n            }\n            var linkedResource = introspectionResults.resources.find(function (r) { return r.type.name === type.name; });\n            if (linkedResource) {\n                return __spreadArrays(acc, [\n                    gqlTypes.field(gqlTypes.name(field.name), null, null, null, gqlTypes.selectionSet([gqlTypes.field(gqlTypes.name('id'))])),\n                ]);\n            }\n            var linkedType = introspectionResults.types.find(function (t) { return t.name === type.name; });\n            if (linkedType && !path.includes(linkedType.name)) {\n                return __spreadArrays(acc, [\n                    gqlTypes.field(gqlTypes.name(field.name), null, null, null, gqlTypes.selectionSet(__spreadArrays(buildFragments(introspectionResults)(linkedType.possibleTypes || []), buildFields(introspectionResults, __spreadArrays(path, [\n                        linkedType.name,\n                    ]))(linkedType.fields)))),\n                ]);\n            }\n            // NOTE: We might have to handle linked types which are not resources but will have to be careful about\n            // ending with endless circular dependencies\n            return acc;\n        }, []);\n    };\n};\nexport var getArgType = function (arg) {\n    var type = getFinalType(arg.type);\n    var required = isRequired(arg.type);\n    var list = isList(arg.type);\n    if (list) {\n        if (required) {\n            return gqlTypes.listType(gqlTypes.nonNullType(gqlTypes.namedType(gqlTypes.name(type.name))));\n        }\n        return gqlTypes.listType(gqlTypes.namedType(gqlTypes.name(type.name)));\n    }\n    if (required) {\n        return gqlTypes.nonNullType(gqlTypes.namedType(gqlTypes.name(type.name)));\n    }\n    return gqlTypes.namedType(gqlTypes.name(type.name));\n};\nexport var buildArgs = function (query, variables) {\n    if (query.args.length === 0) {\n        return [];\n    }\n    var validVariables = Object.keys(variables).filter(function (k) { return typeof variables[k] !== 'undefined'; });\n    var args = query.args\n        .filter(function (a) { return validVariables.includes(a.name); })\n        .reduce(function (acc, arg) { return __spreadArrays(acc, [\n        gqlTypes.argument(gqlTypes.name(arg.name), gqlTypes.variable(gqlTypes.name(arg.name))),\n    ]); }, []);\n    return args;\n};\nexport var buildApolloArgs = function (query, variables) {\n    if (query.args.length === 0) {\n        return [];\n    }\n    var validVariables = Object.keys(variables).filter(function (k) { return typeof variables[k] !== 'undefined'; });\n    var args = query.args\n        .filter(function (a) { return validVariables.includes(a.name); })\n        .reduce(function (acc, arg) {\n        return __spreadArrays(acc, [\n            gqlTypes.variableDefinition(gqlTypes.variable(gqlTypes.name(arg.name)), getArgType(arg)),\n        ]);\n    }, []);\n    return args;\n};\nexport default (function (introspectionResults) { return function (resource, aorFetchType, queryType, variables) {\n    var sortField = variables.sortField, sortOrder = variables.sortOrder, metaVariables = __rest(variables, [\"sortField\", \"sortOrder\"]);\n    var apolloArgs = buildApolloArgs(queryType, variables);\n    var args = buildArgs(queryType, variables);\n    var metaArgs = buildArgs(queryType, metaVariables);\n    var fields = buildFields(introspectionResults)(resource.type.fields);\n    if (aorFetchType === GET_LIST ||\n        aorFetchType === GET_MANY ||\n        aorFetchType === GET_MANY_REFERENCE) {\n        return gqlTypes.document([\n            gqlTypes.operationDefinition('query', gqlTypes.selectionSet([\n                gqlTypes.field(gqlTypes.name(queryType.name), gqlTypes.name('items'), args, null, gqlTypes.selectionSet(fields)),\n                gqlTypes.field(gqlTypes.name(\"_\" + queryType.name + \"Meta\"), gqlTypes.name('total'), metaArgs, null, gqlTypes.selectionSet([\n                    gqlTypes.field(gqlTypes.name('count')),\n                ])),\n            ]), gqlTypes.name(queryType.name), apolloArgs),\n        ]);\n    }\n    if (aorFetchType === DELETE) {\n        return gqlTypes.document([\n            gqlTypes.operationDefinition('mutation', gqlTypes.selectionSet([\n                gqlTypes.field(gqlTypes.name(queryType.name), gqlTypes.name('data'), args, null, gqlTypes.selectionSet(fields)),\n            ]), gqlTypes.name(queryType.name), apolloArgs),\n        ]);\n    }\n    return gqlTypes.document([\n        gqlTypes.operationDefinition(QUERY_TYPES.includes(aorFetchType) ? 'query' : 'mutation', gqlTypes.selectionSet([\n            gqlTypes.field(gqlTypes.name(queryType.name), gqlTypes.name('data'), args, null, gqlTypes.selectionSet(fields)),\n        ]), gqlTypes.name(queryType.name), apolloArgs),\n    ]);\n}; });\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { GET_LIST, GET_MANY, GET_MANY_REFERENCE } from 'ra-core';\nvar sanitizeResource = function (data) {\n    var result = Object.keys(data).reduce(function (acc, key) {\n        var _a, _b, _c, _d, _e;\n        if (key.startsWith('_')) {\n            return acc;\n        }\n        var dataKey = data[key];\n        if (dataKey === null || dataKey === undefined) {\n            return acc;\n        }\n        if (Array.isArray(dataKey)) {\n            if (typeof dataKey[0] === 'object' && dataKey[0] !== null) {\n                return __assign(__assign({}, acc), (_a = {}, _a[key] = dataKey.map(sanitizeResource), _a[key + \"Ids\"] = dataKey.map(function (d) { return d.id; }), _a));\n            }\n            else {\n                return __assign(__assign({}, acc), (_b = {}, _b[key] = dataKey, _b));\n            }\n        }\n        if (typeof dataKey === 'object' && dataKey !== null) {\n            return __assign(__assign(__assign({}, acc), (dataKey &&\n                dataKey.id && (_c = {},\n                _c[key + \".id\"] = dataKey.id,\n                _c))), (_d = {}, _d[key] = sanitizeResource(dataKey), _d));\n        }\n        return __assign(__assign({}, acc), (_e = {}, _e[key] = dataKey, _e));\n    }, {});\n    return result;\n};\nexport default (function (introspectionResults) { return function (aorFetchType) { return function (response) {\n    var data = response.data;\n    if (aorFetchType === GET_LIST ||\n        aorFetchType === GET_MANY ||\n        aorFetchType === GET_MANY_REFERENCE) {\n        return {\n            data: response.data.items.map(sanitizeResource),\n            total: response.data.total.count,\n        };\n    }\n    return { data: sanitizeResource(data.data) };\n}; }; });\n","import buildVariables from './buildVariables';\nimport buildGqlQuery from './buildGqlQuery';\nimport getResponseParser from './getResponseParser';\nexport var buildQueryFactory = function (buildVariablesImpl, buildGqlQueryImpl, getResponseParserImpl) { return function (introspectionResults) {\n    var knownResources = introspectionResults.resources.map(function (r) { return r.type.name; });\n    return function (aorFetchType, resourceName, params) {\n        var resource = introspectionResults.resources.find(function (r) { return r.type.name === resourceName; });\n        if (!resource) {\n            throw new Error(\"Unknown resource \" + resourceName + \". Make sure it has been declared on your server side schema. Known resources are \" + knownResources.join(', '));\n        }\n        var queryType = resource[aorFetchType];\n        if (!queryType) {\n            throw new Error(\"No query or mutation matching fetch type \" + aorFetchType + \" could be found for resource \" + resource.type.name);\n        }\n        var variables = buildVariablesImpl(introspectionResults)(resource, aorFetchType, params, queryType);\n        var query = buildGqlQueryImpl(introspectionResults)(resource, aorFetchType, queryType, variables);\n        var parseResponse = getResponseParserImpl(introspectionResults)(aorFetchType, resource, queryType);\n        return {\n            query: query,\n            variables: variables,\n            parseResponse: parseResponse,\n        };\n    };\n}; };\nexport default buildQueryFactory(buildVariables, buildGqlQuery, getResponseParser);\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport merge from 'lodash/merge';\nimport buildDataProvider from 'ra-data-graphql';\nimport { DELETE, DELETE_MANY, UPDATE, UPDATE_MANY } from 'ra-core';\nimport defaultBuildQuery from './buildQuery';\nvar defaultOptions = {\n    buildQuery: defaultBuildQuery,\n};\nexport var buildQuery = defaultBuildQuery;\nexport default (function (options) {\n    return buildDataProvider(merge({}, defaultOptions, options)).then(function (defaultDataProvider) {\n        return function (fetchType, resource, params) {\n            // This provider does not support multiple deletions so instead we send multiple DELETE requests\n            // This can be optimized using the apollo-link-batch-http link\n            if (fetchType === DELETE_MANY) {\n                var ids = params.ids, otherParams_1 = __rest(params, [\"ids\"]);\n                return Promise.all(ids.map(function (id) {\n                    return defaultDataProvider(DELETE, resource, __assign({ id: id }, otherParams_1));\n                })).then(function (results) {\n                    var data = results.reduce(function (acc, _a) {\n                        var data = _a.data;\n                        return __spreadArrays(acc, [data.id]);\n                    }, []);\n                    return { data: data };\n                });\n            }\n            // This provider does not support multiple deletions so instead we send multiple UPDATE requests\n            // This can be optimized using the apollo-link-batch-http link\n            if (fetchType === UPDATE_MANY) {\n                var ids = params.ids, data_1 = params.data, otherParams_2 = __rest(params, [\"ids\", \"data\"]);\n                return Promise.all(ids.map(function (id) {\n                    return defaultDataProvider(UPDATE, resource, __assign({ data: __assign({ id: id }, data_1) }, otherParams_2));\n                })).then(function (results) {\n                    var data = results.reduce(function (acc, _a) {\n                        var data = _a.data;\n                        return __spreadArrays(acc, [data.id]);\n                    }, []);\n                    return { data: data };\n                });\n            }\n            return defaultDataProvider(fetchType, resource, params);\n        };\n    });\n});\n","import { ApolloQueryResult } from 'apollo-client';\nimport buildApolloClient, {\n    buildQuery as buildQueryFactory,\n} from 'ra-data-graphql-simple';\nimport { DELETE, LegacyDataProvider } from 'react-admin';\nimport gql from 'graphql-tag';\nimport {\n    IntrospectionField,\n    IntrospectionSchema,\n    IntrospectionType,\n} from 'graphql';\n\nconst getGqlResource = (resource: string) => {\n    switch (resource) {\n        case 'customers':\n            return 'Customer';\n\n        case 'categories':\n            return 'Category';\n\n        case 'commands':\n            return 'Command';\n\n        case 'products':\n            return 'Product';\n\n        case 'reviews':\n            return 'Review';\n\n        case 'invoices':\n            return 'Invoice';\n\n        default:\n            throw new Error(`Unknown resource ${resource}`);\n    }\n};\n\ntype IntrospectionResource = IntrospectionType & {\n    [key: string]: IntrospectionField;\n};\n\ninterface IntrospectionResults {\n    types: IntrospectionType[];\n    queries: IntrospectionField[];\n    resources: IntrospectionResource[];\n    schema: IntrospectionSchema;\n}\n\nconst customBuildQuery = (\n    introspectionResults: IntrospectionResults\n): LegacyDataProvider => {\n    const buildQuery = buildQueryFactory(introspectionResults);\n\n    return (type, resource, params) => {\n        if (type === DELETE) {\n            return {\n                query: gql`mutation remove${resource}($id: ID!) {\n                    remove${resource}(id: $id)\n                }`,\n                variables: { id: params.id },\n                parseResponse: ({ data }: ApolloQueryResult<any>) => {\n                    if (data[`remove${resource}`]) {\n                        return { data: { id: params.id } };\n                    }\n\n                    throw new Error(`Could not delete ${resource}`);\n                },\n            };\n        }\n\n        return buildQuery(type, resource, params);\n    };\n};\n\nexport default async () => {\n    const dataProvider = await buildApolloClient({\n        clientOptions: {\n            uri: 'http://localhost:4000/graphql',\n        },\n        introspection: {\n            operationNames: {\n                [DELETE]: (resource: IntrospectionType) =>\n                    `remove${resource.name}`,\n            },\n        },\n        buildQuery: customBuildQuery,\n    });\n\n    return (type: string, resource: string, params: any) => {\n        return dataProvider(type, getGqlResource(resource), params);\n    };\n};\n"],"sourceRoot":""}