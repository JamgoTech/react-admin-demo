{"version":3,"sources":["../../../packages/ra-data-graphql/esm/introspection.js","../../../packages/ra-data-graphql/esm/index.js","../../../packages/ra-data-graphql-simple/esm/buildQuery.js","../../../packages/ra-data-graphql/esm/buildApolloClient.js","../../../packages/ra-data-graphql/esm/constants.js","../../../packages/ra-data-graphql-simple/esm/getFinalType.js","../../../packages/ra-data-graphql-simple/esm/isList.js","../../../packages/ra-data-graphql-simple/esm/buildVariables.js","../../../packages/ra-data-graphql-simple/esm/isRequired.js","../../../packages/ra-data-graphql-simple/esm/buildGqlQuery.js","../../../packages/ra-data-graphql-simple/esm/getResponseParser.js","../../../packages/ra-data-graphql-simple/esm/index.js","dataProvider/graphql.js"],"names":["templateObject_1","buildVariablesImpl","buildGqlQueryImpl","getResponseParserImpl","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","QUERY_TYPES","MUTATION_TYPES","ALL_TYPES","concat","__makeTemplateObject","cooked","raw","defineProperty","value","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","rejected","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","Symbol","iterator","v","op","TypeError","pop","push","defaultOptions","resolveIntrospection","schema","_a","queries","types","isResource","buildResource","potentialResources","filteredResources","resources","_b","options","client","query","fetchPolicy","introspectionQuery","data","__schema","reduce","acc","type","name","queryType","mutationType","fields","filter","some","operationNames","aorFetchType","find","include","exclude","Array","isArray","includes","filterTypesByIncludeExclude","map","introspection","resource","undefined","getOptions","clientObject","clientOptions","buildQueryFactory","override","otherOptions","introspectionResults","buildQuery","raDataProvider","_c","console","warn","cache","link","uri","finalLink","finalCache","restore","buildApolloClient","params","overriddenBuildQuery","parseResponse","getQueryOperation","apolloQuery_1","response","apolloQuery","mutation","variables","mutate","observeRequest","watchQuery","saga","definitions","operation","Error","getFinalType","kind","NON_NULL","LIST","ofType","isList","sanitizeValue","parseInt","parseFloat","prepareParams","keys","forEach","key","param","arg","args","item","File","inputFields","Number","String","Boolean","castType","isRequired","required","validVariables","k","a","sanitizeResource","_d","_e","startsWith","dataKey","d","id","preparedParams","_f","_g","ids","filterSome","filter_1","filter_acc","parts","split","resourceField_1","resourceField","type_2","isAList","page","pagination","perPage","sortField","sort","field","sortOrder","order","target","buildCreateUpdateVariables","metaVariables","apolloArgs","metaArgs","buildFields","path","OBJECT","INTERFACE","r","linkedType","items","total","count","knownResources","resourceName","join","customBuildQuery","DELETE","gql","defaultDataProvider","fetchType","otherParams_1","all","results","data_1","otherParams_2","dataProvider","getGqlResource"],"mappings":"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","file":"static/js/7.10c3f492.chunk.js","sourcesContent":["var __makeTemplateObject = this && this.__makeTemplateObject || function (cooked, raw) {\n  if (Object.defineProperty) {\n    Object.defineProperty(cooked, \"raw\", {\n      value: raw\n    });\n  } else {\n    cooked.raw = raw;\n  }\n\n  return cooked;\n};\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : new P(function (resolve) {\n        resolve(result.value);\n      }).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function sent() {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) {\n      try {\n        if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n        if (y = 0, t) op = [op[0] & 2, t.value];\n\n        switch (op[0]) {\n          case 0:\n          case 1:\n            t = op;\n            break;\n\n          case 4:\n            _.label++;\n            return {\n              value: op[1],\n              done: false\n            };\n\n          case 5:\n            _.label++;\n            y = op[1];\n            op = [0];\n            continue;\n\n          case 7:\n            op = _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n\n          default:\n            if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n              _ = 0;\n              continue;\n            }\n\n            if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n              _.label = op[1];\n              break;\n            }\n\n            if (op[0] === 6 && _.label < t[1]) {\n              _.label = t[1];\n              t = op;\n              break;\n            }\n\n            if (t && _.label < t[2]) {\n              _.label = t[2];\n\n              _.ops.push(op);\n\n              break;\n            }\n\n            if (t[2]) _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n        }\n\n        op = body.call(thisArg, _);\n      } catch (e) {\n        op = [6, e];\n        y = 0;\n      } finally {\n        f = t = 0;\n      }\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nvar _this = this;\n\nimport { introspectionQuery } from 'graphql';\nimport gql from 'graphql-tag';\nimport { GET_LIST, GET_ONE } from 'ra-core';\nimport { ALL_TYPES } from './constants';\nexport var filterTypesByIncludeExclude = function filterTypesByIncludeExclude(_a) {\n  var include = _a.include,\n      exclude = _a.exclude;\n\n  if (Array.isArray(include)) {\n    return function (type) {\n      return include.includes(type.name);\n    };\n  }\n\n  if (typeof include === 'function') {\n    return function (type) {\n      return include(type);\n    };\n  }\n\n  if (Array.isArray(exclude)) {\n    return function (type) {\n      return !exclude.includes(type.name);\n    };\n  }\n\n  if (typeof exclude === 'function') {\n    return function (type) {\n      return !exclude(type);\n    };\n  }\n\n  return function () {\n    return true;\n  };\n};\n/**\n * @param {ApolloClient} client The Apollo client\n * @param {Object} options The introspection options\n */\n\nexport default (function (client, options) {\n  return __awaiter(_this, void 0, void 0, function () {\n    var schema, _a, queries, types, isResource, buildResource, potentialResources, filteredResources, resources;\n\n    return __generator(this, function (_b) {\n      switch (_b.label) {\n        case 0:\n          if (!options.schema) return [3\n          /*break*/\n          , 1];\n          _a = options.schema;\n          return [3\n          /*break*/\n          , 3];\n\n        case 1:\n          return [4\n          /*yield*/\n          , client.query({\n            fetchPolicy: 'network-only',\n            query: gql(templateObject_1 || (templateObject_1 = __makeTemplateObject([\"\\n                      \", \"\\n                  \"], [\"\\n                      \", \"\\n                  \"])), introspectionQuery)\n          }).then(function (_a) {\n            var __schema = _a.data.__schema;\n            return __schema;\n          })];\n\n        case 2:\n          _a = _b.sent();\n          _b.label = 3;\n\n        case 3:\n          schema = _a;\n          queries = schema.types.reduce(function (acc, type) {\n            if (type.name !== schema.queryType.name && type.name !== schema.mutationType.name) return acc;\n            return acc.concat(type.fields);\n          }, []);\n          types = schema.types.filter(function (type) {\n            return type.name !== schema.queryType.name && type.name !== schema.mutationType.name;\n          });\n\n          isResource = function isResource(type) {\n            return queries.some(function (query) {\n              return query.name === options.operationNames[GET_LIST](type);\n            }) && queries.some(function (query) {\n              return query.name === options.operationNames[GET_ONE](type);\n            });\n          };\n\n          buildResource = function buildResource(type) {\n            return ALL_TYPES.reduce(function (acc, aorFetchType) {\n              var _a;\n\n              return __assign({}, acc, (_a = {}, _a[aorFetchType] = queries.find(function (query) {\n                return options.operationNames[aorFetchType] && query.name === options.operationNames[aorFetchType](type);\n              }), _a));\n            }, {\n              type: type\n            });\n          };\n\n          potentialResources = types.filter(isResource);\n          filteredResources = potentialResources.filter(filterTypesByIncludeExclude(options));\n          resources = filteredResources.map(buildResource);\n          return [2\n          /*return*/\n          , {\n            types: types,\n            queries: queries,\n            resources: resources,\n            schema: schema\n          }];\n      }\n    });\n  });\n});\nvar templateObject_1;","var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : new P(function (resolve) {\n        resolve(result.value);\n      }).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function sent() {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) {\n      try {\n        if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n        if (y = 0, t) op = [op[0] & 2, t.value];\n\n        switch (op[0]) {\n          case 0:\n          case 1:\n            t = op;\n            break;\n\n          case 4:\n            _.label++;\n            return {\n              value: op[1],\n              done: false\n            };\n\n          case 5:\n            _.label++;\n            y = op[1];\n            op = [0];\n            continue;\n\n          case 7:\n            op = _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n\n          default:\n            if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n              _ = 0;\n              continue;\n            }\n\n            if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n              _.label = op[1];\n              break;\n            }\n\n            if (op[0] === 6 && _.label < t[1]) {\n              _.label = t[1];\n              t = op;\n              break;\n            }\n\n            if (t && _.label < t[2]) {\n              _.label = t[2];\n\n              _.ops.push(op);\n\n              break;\n            }\n\n            if (t[2]) _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n        }\n\n        op = body.call(thisArg, _);\n      } catch (e) {\n        op = [6, e];\n        y = 0;\n      } finally {\n        f = t = 0;\n      }\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nvar _a;\n\nvar _this = this;\n\nimport merge from 'lodash/merge';\nimport get from 'lodash/get';\nimport pluralize from 'pluralize';\nimport { GET_LIST, GET_ONE, GET_MANY, GET_MANY_REFERENCE, CREATE, UPDATE, DELETE } from 'ra-core';\nimport buildApolloClient from './buildApolloClient';\nimport { QUERY_TYPES as INNER_QUERY_TYPES, MUTATION_TYPES as INNER_MUTATION_TYPES, ALL_TYPES as INNER_ALL_TYPES } from './constants';\nimport defaultResolveIntrospection from './introspection';\nexport var QUERY_TYPES = INNER_QUERY_TYPES;\nexport var MUTATION_TYPES = INNER_MUTATION_TYPES;\nexport var ALL_TYPES = INNER_ALL_TYPES;\nvar defaultOptions = {\n  resolveIntrospection: defaultResolveIntrospection,\n  introspection: {\n    operationNames: (_a = {}, _a[GET_LIST] = function (resource) {\n      return \"all\" + pluralize(resource.name);\n    }, _a[GET_ONE] = function (resource) {\n      return \"\" + resource.name;\n    }, _a[GET_MANY] = function (resource) {\n      return \"all\" + pluralize(resource.name);\n    }, _a[GET_MANY_REFERENCE] = function (resource) {\n      return \"all\" + pluralize(resource.name);\n    }, _a[CREATE] = function (resource) {\n      return \"create\" + resource.name;\n    }, _a[UPDATE] = function (resource) {\n      return \"update\" + resource.name;\n    }, _a[DELETE] = function (resource) {\n      return \"delete\" + resource.name;\n    }, _a),\n    exclude: undefined,\n    include: undefined\n  }\n};\n\nvar getOptions = function getOptions(options, aorFetchType, resource) {\n  if (typeof options === 'function') {\n    return options(resource, aorFetchType);\n  }\n\n  return options;\n};\n\nexport default (function (options) {\n  return __awaiter(_this, void 0, void 0, function () {\n    var _a, clientObject, clientOptions, introspection, resolveIntrospection, buildQueryFactory, _b, override, otherOptions, client, introspectionResults, buildQuery, raDataProvider;\n\n    return __generator(this, function (_c) {\n      switch (_c.label) {\n        case 0:\n          _a = merge({}, defaultOptions, options), clientObject = _a.client, clientOptions = _a.clientOptions, introspection = _a.introspection, resolveIntrospection = _a.resolveIntrospection, buildQueryFactory = _a.buildQuery, _b = _a.override, override = _b === void 0 ? {} : _b, otherOptions = __rest(_a, [\"client\", \"clientOptions\", \"introspection\", \"resolveIntrospection\", \"buildQuery\", \"override\"]);\n\n          if (override && process.env.NODE_ENV === 'production') {\n            console.warn( // eslint-disable-line\n            'The override option is deprecated. You should instead wrap the buildQuery function provided by the dataProvider you use.');\n          }\n\n          client = clientObject || buildApolloClient(clientOptions);\n          if (!introspection) return [3\n          /*break*/\n          , 2];\n          return [4\n          /*yield*/\n          , resolveIntrospection(client, introspection)];\n\n        case 1:\n          introspectionResults = _c.sent();\n          _c.label = 2;\n\n        case 2:\n          buildQuery = buildQueryFactory(introspectionResults, otherOptions);\n\n          raDataProvider = function raDataProvider(aorFetchType, resource, params) {\n            var overriddenBuildQuery = get(override, resource + \".\" + aorFetchType);\n\n            var _a = overriddenBuildQuery ? __assign({}, buildQuery(aorFetchType, resource, params), overriddenBuildQuery(params)) : buildQuery(aorFetchType, resource, params),\n                parseResponse = _a.parseResponse,\n                query = __rest(_a, [\"parseResponse\"]);\n\n            var operation = getQueryOperation(query.query);\n\n            if (operation === 'query') {\n              var apolloQuery_1 = __assign({}, query, {\n                fetchPolicy: 'network-only'\n              }, getOptions(otherOptions.query, aorFetchType, resource));\n\n              return client.query(apolloQuery_1).then(function (response) {\n                return parseResponse(response);\n              });\n            }\n\n            var apolloQuery = __assign({\n              mutation: query.query,\n              variables: query.variables\n            }, getOptions(otherOptions.mutation, aorFetchType, resource));\n\n            return client.mutate(apolloQuery).then(parseResponse);\n          };\n\n          raDataProvider.observeRequest = function (aorFetchType, resource, params) {\n            var _a = buildQuery(aorFetchType, resource, params),\n                parseResponse = _a.parseResponse,\n                query = __rest(_a, [\"parseResponse\"]);\n\n            var apolloQuery = __assign({}, query, getOptions(otherOptions.watchQuery, aorFetchType, resource));\n\n            return client.watchQuery(apolloQuery).then(parseResponse);\n          };\n\n          raDataProvider.saga = function () {};\n\n          return [2\n          /*return*/\n          , raDataProvider];\n      }\n    });\n  });\n});\n\nvar getQueryOperation = function getQueryOperation(query) {\n  if (query && query.definitions && query.definitions.length > 0) {\n    return query.definitions[0].operation;\n  }\n\n  throw new Error('Unable to determine the query operation');\n};","import buildVariables from './buildVariables';\nimport buildGqlQuery from './buildGqlQuery';\nimport getResponseParser from './getResponseParser';\nexport var buildQueryFactory = function buildQueryFactory(buildVariablesImpl, buildGqlQueryImpl, getResponseParserImpl) {\n  return function (introspectionResults) {\n    var knownResources = introspectionResults.resources.map(function (r) {\n      return r.type.name;\n    });\n    return function (aorFetchType, resourceName, params) {\n      var resource = introspectionResults.resources.find(function (r) {\n        return r.type.name === resourceName;\n      });\n\n      if (!resource) {\n        throw new Error(\"Unknown resource \" + resourceName + \". Make sure it has been declared on your server side schema. Known resources are \" + knownResources.join(', '));\n      }\n\n      var queryType = resource[aorFetchType];\n\n      if (!queryType) {\n        throw new Error(\"No query or mutation matching fetch type \" + aorFetchType + \" could be found for resource \" + resource.type.name);\n      }\n\n      var variables = buildVariablesImpl(introspectionResults)(resource, aorFetchType, params, queryType);\n      var query = buildGqlQueryImpl(introspectionResults)(resource, aorFetchType, queryType, variables);\n      var parseResponse = getResponseParserImpl(introspectionResults)(aorFetchType, resource, queryType);\n      return {\n        query: query,\n        variables: variables,\n        parseResponse: parseResponse\n      };\n    };\n  };\n};\nexport default buildQueryFactory(buildVariables, buildGqlQuery, getResponseParser);","var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport { ApolloClient } from 'apollo-client';\nimport { HttpLink, InMemoryCache } from 'apollo-client-preset';\nexport default (function (options) {\n  if (!options) {\n    return new ApolloClient();\n  }\n\n  var cache = options.cache,\n      link = options.link,\n      uri = options.uri,\n      otherOptions = __rest(options, [\"cache\", \"link\", \"uri\"]);\n\n  var finalLink = link;\n  var finalCache = cache;\n\n  if (!link && uri) {\n    finalLink = new HttpLink({\n      uri: uri\n    });\n  }\n\n  if (!cache) {\n    finalCache = new InMemoryCache().restore({});\n  }\n\n  return new ApolloClient(__assign({\n    link: finalLink,\n    cache: finalCache\n  }, otherOptions));\n});","import { GET_LIST, GET_ONE, GET_MANY, GET_MANY_REFERENCE, CREATE, UPDATE, UPDATE_MANY, DELETE, DELETE_MANY } from 'ra-core';\nexport var QUERY_TYPES = [GET_LIST, GET_MANY, GET_MANY_REFERENCE, GET_ONE];\nexport var MUTATION_TYPES = [CREATE, UPDATE, DELETE, UPDATE_MANY, DELETE_MANY];\nexport var ALL_TYPES = QUERY_TYPES.concat(MUTATION_TYPES);","import { TypeKind } from 'graphql';\n/**\n * Ensure we get the real type even if the root type is NON_NULL or LIST\n * @param {GraphQLType} type\n */\n\nvar getFinalType = function getFinalType(type) {\n  if (type.kind === TypeKind.NON_NULL || type.kind === TypeKind.LIST) {\n    return getFinalType(type.ofType);\n  }\n\n  return type;\n};\n\nexport default getFinalType;","import { TypeKind } from 'graphql';\n\nvar isList = function isList(type) {\n  if (type.kind === TypeKind.NON_NULL) {\n    return isList(type.ofType);\n  }\n\n  return type.kind === TypeKind.LIST;\n};\n\nexport default isList;","var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n/* eslint-disable default-case */\n\n\nimport { GET_LIST, GET_ONE, GET_MANY, GET_MANY_REFERENCE, CREATE, UPDATE, DELETE } from 'ra-core';\nimport getFinalType from './getFinalType';\nimport isList from './isList';\n\nvar sanitizeValue = function sanitizeValue(type, value) {\n  if (type.name === 'Int') {\n    return parseInt(value, 10);\n  }\n\n  if (type.name === 'Float') {\n    return parseFloat(value);\n  }\n\n  return value;\n};\n\nvar castType = function castType(value, type) {\n  switch (type.kind + \":\" + type.name) {\n    case 'SCALAR:Int':\n      return Number(value);\n\n    case 'SCALAR:String':\n      return String(value);\n\n    case 'SCALAR:Boolean':\n      return Boolean(value);\n\n    default:\n      return value;\n  }\n};\n\nvar prepareParams = function prepareParams(params, queryType, introspectionResults) {\n  var result = {};\n\n  if (!params) {\n    return params;\n  }\n\n  Object.keys(params).forEach(function (key) {\n    var param = params[key];\n    var arg = null;\n\n    if (!param) {\n      result[key] = param;\n      return;\n    }\n\n    if (queryType && Array.isArray(queryType.args)) {\n      arg = queryType.args.find(function (item) {\n        return item.name === key;\n      });\n    }\n\n    if (param instanceof File) {\n      result[key] = param;\n      return;\n    }\n\n    if (param instanceof Object && !Array.isArray(param) && arg && arg.type.kind === 'INPUT_OBJECT') {\n      var args = introspectionResults.types.find(function (item) {\n        return item.kind === arg.type.kind && item.name === arg.type.name;\n      }).inputFields;\n      result[key] = prepareParams(param, {\n        args: args\n      }, introspectionResults);\n      return;\n    }\n\n    if (param instanceof Object && !Array.isArray(param)) {\n      result[key] = prepareParams(param, queryType, introspectionResults);\n      return;\n    }\n\n    if (!arg) {\n      result[key] = param;\n      return;\n    }\n\n    result[key] = castType(param, arg.type);\n  });\n  return result;\n};\n\nvar buildGetListVariables = function buildGetListVariables(introspectionResults) {\n  return function (resource, aorFetchType, params) {\n    var filter = Object.keys(params.filter).reduce(function (acc, key) {\n      var _a, _b, _c, _d, _e, _f, _g;\n\n      if (key === 'ids') {\n        return __assign({}, acc, {\n          ids: params.filter[key]\n        });\n      }\n\n      if (typeof params.filter[key] === 'object') {\n        var type = introspectionResults.types.find(function (t) {\n          return t.name === resource.type.name + \"Filter\";\n        });\n        var filterSome = type.inputFields.find(function (t) {\n          return t.name === key + \"_some\";\n        });\n\n        if (filterSome) {\n          var filter_1 = Object.keys(params.filter[key]).reduce(function (filter_acc, k) {\n            var _a;\n\n            return __assign({}, filter_acc, (_a = {}, _a[k + \"_in\"] = params.filter[key][k], _a));\n          }, {});\n          return __assign({}, acc, (_a = {}, _a[key + \"_some\"] = filter_1, _a));\n        }\n      }\n\n      var parts = key.split('.');\n\n      if (parts.length > 1) {\n        if (parts[1] === 'id') {\n          var type_1 = introspectionResults.types.find(function (t) {\n            return t.name === resource.type.name + \"Filter\";\n          });\n          var filterSome = type_1.inputFields.find(function (t) {\n            return t.name === parts[0] + \"_some\";\n          });\n\n          if (filterSome) {\n            return __assign({}, acc, (_b = {}, _b[parts[0] + \"_some\"] = {\n              id: params.filter[key]\n            }, _b));\n          }\n\n          return __assign({}, acc, (_c = {}, _c[parts[0]] = {\n            id: params.filter[key]\n          }, _c));\n        }\n\n        var resourceField_1 = resource.type.fields.find(function (f) {\n          return f.name === parts[0];\n        });\n        var type = getFinalType(resourceField_1.type);\n        return __assign({}, acc, (_d = {}, _d[key] = sanitizeValue(type, params.filter[key]), _d));\n      }\n\n      var resourceField = resource.type.fields.find(function (f) {\n        return f.name === key;\n      });\n\n      if (resourceField) {\n        var type_2 = getFinalType(resourceField.type);\n        var isAList = isList(resourceField.type);\n\n        if (isAList) {\n          return __assign({}, acc, (_e = {}, _e[key] = Array.isArray(params.filter[key]) ? params.filter[key].map(function (value) {\n            return sanitizeValue(type_2, value);\n          }) : sanitizeValue(type_2, [params.filter[key]]), _e));\n        }\n\n        return __assign({}, acc, (_f = {}, _f[key] = sanitizeValue(type_2, params.filter[key]), _f));\n      }\n\n      return __assign({}, acc, (_g = {}, _g[key] = params.filter[key], _g));\n    }, {});\n    return {\n      page: parseInt(params.pagination.page, 10) - 1,\n      perPage: parseInt(params.pagination.perPage, 10),\n      sortField: params.sort.field,\n      sortOrder: params.sort.order,\n      filter: filter\n    };\n  };\n};\n\nvar buildCreateUpdateVariables = function buildCreateUpdateVariables(resource, aorFetchType, params, queryType) {\n  return Object.keys(params.data).reduce(function (acc, key) {\n    var _a, _b, _c;\n\n    if (Array.isArray(params.data[key])) {\n      var arg = queryType.args.find(function (a) {\n        return a.name === key + \"Ids\";\n      });\n\n      if (arg) {\n        return __assign({}, acc, (_a = {}, _a[key + \"Ids\"] = params.data[key].map(function (_a) {\n          var id = _a.id;\n          return id;\n        }), _a));\n      }\n    }\n\n    if (typeof params.data[key] === 'object') {\n      var arg = queryType.args.find(function (a) {\n        return a.name === key + \"Id\";\n      });\n\n      if (arg) {\n        return __assign({}, acc, (_b = {}, _b[key + \"Id\"] = params.data[key].id, _b));\n      }\n    }\n\n    return __assign({}, acc, (_c = {}, _c[key] = params.data[key], _c));\n  }, {});\n};\n\nexport default (function (introspectionResults) {\n  return function (resource, aorFetchType, params, queryType) {\n    var _a;\n\n    var preparedParams = prepareParams(params, queryType, introspectionResults);\n\n    switch (aorFetchType) {\n      case GET_LIST:\n        {\n          return buildGetListVariables(introspectionResults)(resource, aorFetchType, preparedParams, queryType);\n        }\n\n      case GET_MANY:\n        return {\n          filter: {\n            ids: preparedParams.ids\n          }\n        };\n\n      case GET_MANY_REFERENCE:\n        {\n          var parts = preparedParams.target.split('.');\n          return {\n            page: parseInt(preparedParams.pagination.page, 10) - 1,\n            perPage: parseInt(preparedParams.pagination.perPage, 10),\n            sortField: preparedParams.sort.field,\n            sortOrder: preparedParams.sort.order,\n            filter: (_a = {}, _a[parts[0] + \"Id\"] = preparedParams.id, _a)\n          };\n        }\n\n      case GET_ONE:\n      case DELETE:\n        return {\n          id: preparedParams.id\n        };\n\n      case CREATE:\n      case UPDATE:\n        {\n          return buildCreateUpdateVariables(resource, aorFetchType, preparedParams, queryType);\n        }\n    }\n  };\n});","import { TypeKind } from 'graphql';\n\nvar isRequired = function isRequired(type) {\n  if (type.kind === TypeKind.LIST) {\n    return isRequired(type.ofType);\n  }\n\n  return type.kind === TypeKind.NON_NULL;\n};\n\nexport default isRequired;","var __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport { GET_LIST, GET_MANY, GET_MANY_REFERENCE, DELETE } from 'ra-core';\nimport { QUERY_TYPES } from 'ra-data-graphql';\nimport { TypeKind } from 'graphql';\nimport * as gqlTypes from 'graphql-ast-types-browser';\nimport getFinalType from './getFinalType';\nimport isList from './isList';\nimport isRequired from './isRequired';\nexport var buildFields = function buildFields(introspectionResults, path) {\n  if (path === void 0) {\n    path = [];\n  }\n\n  return function (fields) {\n    return fields.reduce(function (acc, field) {\n      var type = getFinalType(field.type);\n\n      if (type.name.startsWith('_')) {\n        return acc;\n      }\n\n      if (type.kind !== TypeKind.OBJECT && type.kind !== TypeKind.INTERFACE) {\n        return acc.concat([gqlTypes.field(gqlTypes.name(field.name))]);\n      }\n\n      var linkedResource = introspectionResults.resources.find(function (r) {\n        return r.type.name === type.name;\n      });\n\n      if (linkedResource) {\n        return acc.concat([gqlTypes.field(gqlTypes.name(field.name), null, null, null, gqlTypes.selectionSet([gqlTypes.field(gqlTypes.name('id'))]))]);\n      }\n\n      var linkedType = introspectionResults.types.find(function (t) {\n        return t.name === type.name;\n      });\n\n      if (linkedType && !path.includes(linkedType.name)) {\n        path.push(linkedType.name);\n        return acc.concat([gqlTypes.field(gqlTypes.name(field.name), null, null, null, gqlTypes.selectionSet(buildFields(introspectionResults, path)(linkedType.fields)))]);\n      } // NOTE: We might have to handle linked types which are not resources but will have to be careful about\n      // ending with endless circular dependencies\n\n\n      return acc;\n    }, []);\n  };\n};\nexport var getArgType = function getArgType(arg) {\n  var type = getFinalType(arg.type);\n  var required = isRequired(arg.type);\n  var list = isList(arg.type);\n\n  if (list) {\n    if (required) {\n      return gqlTypes.listType(gqlTypes.nonNullType(gqlTypes.namedType(gqlTypes.name(type.name))));\n    }\n\n    return gqlTypes.listType(gqlTypes.namedType(gqlTypes.name(type.name)));\n  }\n\n  if (required) {\n    return gqlTypes.nonNullType(gqlTypes.namedType(gqlTypes.name(type.name)));\n  }\n\n  return gqlTypes.namedType(gqlTypes.name(type.name));\n};\nexport var buildArgs = function buildArgs(query, variables) {\n  if (query.args.length === 0) {\n    return [];\n  }\n\n  var validVariables = Object.keys(variables).filter(function (k) {\n    return typeof variables[k] !== 'undefined';\n  });\n  var args = query.args.filter(function (a) {\n    return validVariables.includes(a.name);\n  }).reduce(function (acc, arg) {\n    return acc.concat([gqlTypes.argument(gqlTypes.name(arg.name), gqlTypes.variable(gqlTypes.name(arg.name)))]);\n  }, []);\n  return args;\n};\nexport var buildApolloArgs = function buildApolloArgs(query, variables) {\n  if (query.args.length === 0) {\n    return [];\n  }\n\n  var validVariables = Object.keys(variables).filter(function (k) {\n    return typeof variables[k] !== 'undefined';\n  });\n  var args = query.args.filter(function (a) {\n    return validVariables.includes(a.name);\n  }).reduce(function (acc, arg) {\n    return acc.concat([gqlTypes.variableDefinition(gqlTypes.variable(gqlTypes.name(arg.name)), getArgType(arg))]);\n  }, []);\n  return args;\n};\nexport default (function (introspectionResults) {\n  return function (resource, aorFetchType, queryType, variables) {\n    var sortField = variables.sortField,\n        sortOrder = variables.sortOrder,\n        metaVariables = __rest(variables, [\"sortField\", \"sortOrder\"]);\n\n    var apolloArgs = buildApolloArgs(queryType, variables);\n    var args = buildArgs(queryType, variables);\n    var metaArgs = buildArgs(queryType, metaVariables);\n    var fields = buildFields(introspectionResults)(resource.type.fields);\n\n    if (aorFetchType === GET_LIST || aorFetchType === GET_MANY || aorFetchType === GET_MANY_REFERENCE) {\n      return gqlTypes.document([gqlTypes.operationDefinition('query', gqlTypes.selectionSet([gqlTypes.field(gqlTypes.name(queryType.name), gqlTypes.name('items'), args, null, gqlTypes.selectionSet(fields)), gqlTypes.field(gqlTypes.name(\"_\" + queryType.name + \"Meta\"), gqlTypes.name('total'), metaArgs, null, gqlTypes.selectionSet([gqlTypes.field(gqlTypes.name('count'))]))]), gqlTypes.name(queryType.name), apolloArgs)]);\n    }\n\n    if (aorFetchType === DELETE) {\n      return gqlTypes.document([gqlTypes.operationDefinition('mutation', gqlTypes.selectionSet([gqlTypes.field(gqlTypes.name(queryType.name), gqlTypes.name('data'), args, null, gqlTypes.selectionSet([gqlTypes.field(gqlTypes.name('id'))]))]), gqlTypes.name(queryType.name), apolloArgs)]);\n    }\n\n    return gqlTypes.document([gqlTypes.operationDefinition(QUERY_TYPES.includes(aorFetchType) ? 'query' : 'mutation', gqlTypes.selectionSet([gqlTypes.field(gqlTypes.name(queryType.name), gqlTypes.name('data'), args, null, gqlTypes.selectionSet(fields))]), gqlTypes.name(queryType.name), apolloArgs)]);\n  };\n});","var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport { GET_LIST, GET_MANY, GET_MANY_REFERENCE } from 'ra-core';\n\nvar sanitizeResource = function sanitizeResource(data) {\n  var result = Object.keys(data).reduce(function (acc, key) {\n    var _a, _b, _c, _d, _e;\n\n    if (key.startsWith('_')) {\n      return acc;\n    }\n\n    var dataKey = data[key];\n\n    if (dataKey === null || dataKey === undefined) {\n      return acc;\n    }\n\n    if (Array.isArray(dataKey)) {\n      if (typeof dataKey[0] === 'object') {\n        return __assign({}, acc, (_a = {}, _a[key] = dataKey.map(sanitizeResource), _a[key + \"Ids\"] = dataKey.map(function (d) {\n          return d.id;\n        }), _a));\n      } else {\n        return __assign({}, acc, (_b = {}, _b[key] = dataKey, _b));\n      }\n    }\n\n    if (typeof dataKey === 'object') {\n      return __assign({}, acc, dataKey && dataKey.id && (_c = {}, _c[key + \".id\"] = dataKey.id, _c), (_d = {}, _d[key] = sanitizeResource(dataKey), _d));\n    }\n\n    return __assign({}, acc, (_e = {}, _e[key] = dataKey, _e));\n  }, {});\n  return result;\n};\n\nexport default (function (introspectionResults) {\n  return function (aorFetchType) {\n    return function (response) {\n      var data = response.data;\n\n      if (aorFetchType === GET_LIST || aorFetchType === GET_MANY || aorFetchType === GET_MANY_REFERENCE) {\n        return {\n          data: response.data.items.map(sanitizeResource),\n          total: response.data.total.count\n        };\n      }\n\n      return {\n        data: sanitizeResource(data.data)\n      };\n    };\n  };\n});","var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport merge from 'lodash/merge';\nimport buildDataProvider from 'ra-data-graphql';\nimport { DELETE, DELETE_MANY, UPDATE, UPDATE_MANY } from 'ra-core';\nimport defaultBuildQuery from './buildQuery';\nvar defaultOptions = {\n  buildQuery: defaultBuildQuery\n};\nexport var buildQuery = defaultBuildQuery;\nexport default (function (options) {\n  return buildDataProvider(merge({}, defaultOptions, options)).then(function (defaultDataProvider) {\n    return function (fetchType, resource, params) {\n      // This provider does not support multiple deletions so instead we send multiple DELETE requests\n      // This can be optimized using the apollo-link-batch-http link\n      if (fetchType === DELETE_MANY) {\n        var ids = params.ids,\n            otherParams_1 = __rest(params, [\"ids\"]);\n\n        return Promise.all(ids.map(function (id) {\n          return defaultDataProvider(DELETE, resource, __assign({\n            id: id\n          }, otherParams_1));\n        })).then(function (results) {\n          var data = results.reduce(function (acc, _a) {\n            var data = _a.data;\n            return acc.concat([data.id]);\n          }, []);\n          return {\n            data: data\n          };\n        });\n      } // This provider does not support multiple deletions so instead we send multiple UPDATE requests\n      // This can be optimized using the apollo-link-batch-http link\n\n\n      if (fetchType === UPDATE_MANY) {\n        var ids = params.ids,\n            data_1 = params.data,\n            otherParams_2 = __rest(params, [\"ids\", \"data\"]);\n\n        return Promise.all(ids.map(function (id) {\n          return defaultDataProvider(UPDATE, resource, __assign({\n            data: __assign({\n              id: id\n            }, data_1)\n          }, otherParams_2));\n        })).then(function (results) {\n          var data = results.reduce(function (acc, _a) {\n            var data = _a.data;\n            return acc.concat([data.id]);\n          }, []);\n          return {\n            data: data\n          };\n        });\n      }\n\n      return defaultDataProvider(fetchType, resource, params);\n    };\n  });\n});","import buildApolloClient, {\n    buildQuery as buildQueryFactory,\n} from 'ra-data-graphql-simple';\nimport { DELETE } from 'ra-core';\nimport gql from 'graphql-tag';\nconst getGqlResource = resource => {\n    switch (resource) {\n        case 'customers':\n            return 'Customer';\n\n        case 'categories':\n            return 'Category';\n\n        case 'commands':\n            return 'Command';\n\n        case 'products':\n            return 'Product';\n\n        case 'reviews':\n            return 'Review';\n\n        case 'invoices':\n            return 'Invoice';\n\n        default:\n            throw new Error(`Unknown resource ${resource}`);\n    }\n};\n\nconst customBuildQuery = introspectionResults => {\n    const buildQuery = buildQueryFactory(introspectionResults);\n\n    return (type, resource, params) => {\n        if (type === DELETE) {\n            return {\n                query: gql`mutation remove${resource}($id: ID!) {\n                    remove${resource}(id: $id)\n                }`,\n                variables: { id: params.id },\n                parseResponse: ({ data }) => {\n                    if (data[`remove${resource}`]) {\n                        return { data: { id: params.id } };\n                    }\n\n                    throw new Error(`Could not delete ${resource}`);\n                },\n            };\n        }\n\n        return buildQuery(type, resource, params);\n    };\n};\n\nexport default () => {\n    return buildApolloClient({\n        clientOptions: {\n            uri: 'http://localhost:4000/graphql',\n        },\n        introspection: {\n            operationNames: {\n                [DELETE]: resource => `remove${resource.name}`,\n            },\n        },\n        buildQuery: customBuildQuery,\n    }).then(dataProvider => (type, resource, params) =>\n        dataProvider(type, getGqlResource(resource), params)\n    );\n};\n"],"sourceRoot":""}